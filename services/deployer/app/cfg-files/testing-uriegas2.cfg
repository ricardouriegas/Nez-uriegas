[BB]
name = Anonimizacion
command = python3 /code/process_dir.py --input @I --outfolder "@D" --save dicom
image = ddomizzi/cleaner:header
[END]

[BB]
name = ToRGB
command = python3 /code/dicom2rgb.py @I @D/@L
image = dicomtorgb:v1
[END]

[BB]
name = DetectorPulmon
command = python3 /code/detectorPulmones.py @I @D/@L
image = ddomizzi/deteccion:pulmon
[END]

[PATTERN]
name = Anonimizacionpattern
task = Anonimizacion
pattern = MW
workers = 2
loadbalancer = TC:DL
[END]

[PATTERN]
name = ToRGBpattern
task = ToRGB
pattern = MW
workers = 2
loadbalancer = TC:DL
[END]

[PATTERN]
name = DetectorPulmonpattern
task = DetectorPulmon
pattern = MW
workers = 2
loadbalancer = TC:DL
[END]

[STAGE]
name = stage_Anonimizacion
source = @PWD/testing-uriegas2/catalogs/TESTCATALOG @PWD/testing-uriegas2/catalogs/TESTCATALOG/P1 @PWD/testing-uriegas2/catalogs/TESTCATALOG/P2 
sink = stage_ToRGB 
transformation = Anonimizacionpattern
[END]

[STAGE]
name = stage_ToRGB
source = stage_Anonimizacion 
sink = stage_DetectorPulmon 
transformation = ToRGBpattern
[END]

[STAGE]
name = stage_DetectorPulmon
source = stage_ToRGB 
sink = 
transformation = DetectorPulmonpattern
[END]

[NFR]
name = Manager/worker
[END]

[NFR]
name = Deduplication
[END]

[NFR]
name = Compression
[END]

[NFR]
name = AES4SEC
[END]

[WORKFLOW]
name = testing-uriegas2
stages = stage_Anonimizacion stage_ToRGB stage_DetectorPulmon 
catalogs = TESTCATALOG:ef342791a194b7e994612bae920db53f0491969ae68bf6f39e56a1339d2a683b TESTCATALOG/P1:fbd52a614aa08837cf3e379f703209854572ad90e09ee49278cfa450ecf94f06 TESTCATALOG/P2:b7f9921dcb6358beabbd88a3198b7d09e3a6f35eb6a9e0e04babc67110783b56 
[END]
